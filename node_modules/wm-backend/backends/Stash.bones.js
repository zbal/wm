/**
 * Example:
 *   var Couch = new Bones.plugin.backends.Couch('db_name');
 */
var Bones = require('bones');
var Backbone = Bones.Backbone;

var Stash = function(type, file) {
    if (typeof type != 'undefined') {
        type = Bones.utils.pluralize(type);
    } else {
        type = null;
    }

    this.initialize(type, file);

    return this.backboneStash;
};

Stash.prototype.initialize = function(type, file) {
    // TODO: check config.
    var config = Bones.plugin.config;
    this.backboneStash = require('backbone-stash')(config.stash + (type ? '/'+ type : ''), file);
};

Stash.augment = Backbone.Router.augment;
Stash.extend = Backbone.Router.extend;

module.exports = Stash;
